<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>BSSPlus Knowledge Hub â€” Private AI Chatbot</title>

  <!-- Tailwind -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');

    body {
      font-family: 'Inter', sans-serif;
      background-color: #0f1117;
      color: #f1f5f9;
    }

    .card-hover {
      transition: transform 0.3s ease, box-shadow 0.3s ease;
    }

    .card-hover:hover {
      transform: translateY(-5px);
      box-shadow: 0 15px 30px -5px rgba(59, 130, 246, 0.2);
    }

    .btn {
      transition: all 0.2s ease;
    }

    .btn:hover {
      transform: scale(1.05);
    }

    .modal {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(0,0,0,0.8);
      z-index: 50;
      justify-content: center;
      align-items: center;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .modal.active {
      display: flex;
      opacity: 1;
    }
    
    /* Ensure inputs remain readable */
    input, textarea, select {
        color: #f1f5f9;
    }
  </style>
</head>
<body>

  <!-- Header -->
  <header class="bg-[#1a1d25] border-b border-gray-800 sticky top-0 z-20">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 h-16 flex items-center justify-between">
      <div class="flex items-center space-x-3">
        <!-- Placeholder for logo image -->
        <div class="h-8 w-8 bg-blue-500 rounded-full flex items-center justify-center text-white font-bold text-lg">B</div>
        <h1 class="text-xl font-bold text-white">BSSPlus <span class="text-blue-500">Knowledge Hub</span></h1>
      </div>
      <div class="flex items-center gap-4">
        <span class="text-sm text-gray-400 hidden sm:inline">Logged in as: <strong>admin</strong></span>
        <button id="logout-btn"
          class="px-4 py-2 text-sm text-white bg-red-600 rounded-lg hover:bg-red-700 btn">
          Logout
        </button>
      </div>
    </div>
  </header>

  <!-- Hero -->
  <section class="text-center py-16 bg-gradient-to-r from-blue-700 via-blue-800 to-indigo-800">
    <h2 class="text-4xl font-extrabold mb-4">Private AI Chatbot Knowledge Hub</h2>
    <p class="text-gray-300 text-lg max-w-2xl mx-auto">
      Manage and organize knowledge that powers your private BSSPlus AI chatbot.
    </p>
    <button onclick="openAddModal()" 
      class="mt-8 px-8 py-3 bg-green-500 text-white rounded-xl font-semibold hover:bg-green-600 btn shadow-lg">
      + Add New Post
    </button>
  </section>

  <!-- Main Content -->
  <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 mt-12 mb-20">

    <!-- Search & Filter -->
    <div class="flex flex-col sm:flex-row gap-4 mb-8">
      <input type="text" id="search-input" placeholder="Search posts by title or content..."
        oninput="filterPosts(this.value)"
        class="flex-grow px-4 py-2 bg-[#1a1d25] border border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
      
      <select id="category-filter" onchange="filterByCategory(this.value)"
        class="px-4 py-2 bg-[#1a1d25] border border-gray-700 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
        <option value="">Filter by Category</option>
        <option value="Training">Training</option>
        <option value="Guidelines">Guidelines</option>
        <option value="Announcements">Announcements</option>
        <option value="Updates">Updates</option>
      </select>

      <button onclick="clearFilters()"
        class="px-4 py-2 bg-gray-800 text-gray-300 rounded-lg hover:bg-gray-700 btn">
        Clear Filters
      </button>
    </div>

    <!-- Post Grid -->
    <section id="posts-container" class="grid sm:grid-cols-2 lg:grid-cols-3 gap-6">
      <!-- Dynamic Posts Will Appear Here -->
    </section>
  </main>

  <!-- Add / Edit Modal -->
  <div id="post-modal" class="modal">
    <div class="bg-[#1a1d25] p-8 rounded-xl shadow-2xl max-w-lg w-full mx-4 relative">
      <h3 id="modal-title" class="text-2xl font-bold mb-4">Add New Post</h3>
      
      <form id="post-form" class="space-y-4">
        <input type="hidden" id="edit-id">
        
        <div>
          <label class="block text-gray-400 mb-1">Title</label>
          <input id="post-title" required placeholder="Enter post title"
            class="w-full px-4 py-2 bg-[#0f1117] border border-gray-700 rounded-lg focus:ring-2 focus:ring-blue-500">
        </div>

        <div>
          <label class="block text-gray-400 mb-1">Category</label>
          <select id="post-category" required
            class="w-full px-4 py-2 bg-[#0f1117] border border-gray-700 rounded-lg focus:ring-2 focus:ring-blue-500">
            <option value="Training">Training</option>
            <option value="Guidelines">Guidelines</option>
            <option value="Announcements">Announcements</option>
            <option value="Updates">Updates</option>
          </select>
        </div>

        <div>
          <label class="block text-gray-400 mb-1">Content</label>
          <textarea id="post-content" rows="5" required placeholder="Write your main content..."
            class="w-full px-4 py-2 bg-[#0f1117] border border-gray-700 rounded-lg focus:ring-2 focus:ring-blue-500"></textarea>
        </div>

        <div class="flex justify-end gap-3 pt-4">
          <button type="button" onclick="closeModal()" 
            class="px-4 py-2 text-gray-400 border border-gray-600 rounded-lg hover:bg-gray-800 btn">
            Cancel
          </button>
          <button type="submit"
            class="px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 btn">
            Save
          </button>
        </div>
      </form>
    </div>
  </div>
  
  <!-- View Post Modal (NEW) -->
  <div id="view-modal" class="modal">
    <div class="bg-[#1a1d25] p-8 rounded-xl shadow-2xl max-w-2xl w-full mx-4 relative">
        <h3 id="view-modal-title" class="text-3xl font-bold mb-2">Post Title</h3>
        <span id="view-modal-category" class="text-xs bg-blue-600 px-2 py-1 rounded font-medium mb-4 inline-block">Category</span>
        <div class="h-1 border-b border-gray-700 mb-6"></div>
        <div id="view-modal-content" class="text-gray-300 max-h-96 overflow-y-auto pr-2 text-base">
            Post Content goes here...
        </div>
        <div class="flex justify-end mt-6">
            <button type="button" onclick="closeViewModal()" 
                class="px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 btn">
                Close
            </button>
        </div>
    </div>
  </div>
  
  <!-- Delete Confirmation Modal (NEW) -->
  <div id="delete-modal" class="modal">
    <div class="bg-[#1a1d25] p-8 rounded-xl shadow-2xl max-w-sm w-full mx-4 relative text-center">
        <h3 class="text-2xl font-bold mb-4 text-red-400">Confirm Deletion</h3>
        <p class="text-gray-300 mb-6">Are you sure you want to delete this post? This action cannot be undone.</p>
        <input type="hidden" id="delete-id">
        <div class="flex justify-center gap-4">
            <button type="button" onclick="closeDeleteModal()" 
                class="px-4 py-2 text-gray-400 border border-gray-600 rounded-lg hover:bg-gray-800 btn">
                Cancel
            </button>
            <button type="button" onclick="confirmDelete()"
                class="px-6 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 btn">
                Delete Permanently
            </button>
        </div>
    </div>
  </div>


  <!-- Footer -->
  <footer class="bg-[#1a1d25] border-t border-gray-800 text-center py-6">
    <p class="text-gray-500">&copy; 2025 BSSPlus. All Rights Reserved.</p>
  </footer>

  <!-- JS Logic (Updated to remove alerts/confirms) -->
  <script>
    const postsContainer = document.getElementById("posts-container");
    const postModal = document.getElementById("post-modal");
    const postForm = document.getElementById("post-form");
    const modalTitle = document.getElementById("modal-title");
    const editId = document.getElementById("edit-id");

    // Sample data
    let posts = [
      { id: 1, title: "Training Basics: Platform Onboarding", category: "Training", content: "Fundamentals of BSSPlus AI chatbot training and how to use the dashboard for content management. This includes setup, data mapping, and initial performance checks." },
      { id: 2, title: "Data Update Policy Changes", category: "Updates", content: "Learn how to apply new update guidelines for quarterly data synchronization. All changes must be reviewed by compliance before deployment." },
      { id: 3, title: "New Q4 Guidelines Released", category: "Guidelines", content: "The Q4 guidelines for project prioritization are now available and mandatory for all managers. Check section 3 for details on resource allocation and budgeting." },
      { id: 4, title: "Upcoming System Maintenance Announcement", category: "Announcements", content: "All systems will undergo scheduled maintenance this Friday at 11 PM GMT for a total of 4 hours. No data access will be available during this time. Please plan accordingly." },
      { id: 5, title: "Advanced Training for Managers", category: "Training", content: "A deep dive into complex data structuring for the AI model. Mandatory for all team leads." },
    ];

    // NEW: Notification function to replace simple alerts
    function showNotification(message, type = 'info') {
      const notification = document.createElement('div');
      let bgColor = 'bg-blue-600';
      if (type === 'error') bgColor = 'bg-red-600';
      else if (type === 'success') bgColor = 'bg-green-600';

      notification.className = `fixed bottom-4 right-4 z-50 px-5 py-3 rounded-lg shadow-xl text-white ${bgColor} transform transition-transform duration-300 ease-in-out opacity-0`;
      notification.textContent = message;
      document.body.appendChild(notification);

      // Animate in
      setTimeout(() => notification.style.opacity = '1', 10);
      
      // Animate out and remove after 3 seconds
      setTimeout(() => {
        notification.style.opacity = '0';
        setTimeout(() => notification.remove(), 300);
      }, 3000);
    }
    
    function renderPosts(list = posts) {
      postsContainer.innerHTML = "";
      if (list.length === 0) {
        postsContainer.innerHTML = '<p class="text-gray-400 col-span-full text-center py-10">No posts found.</p>';
        return;
      }
      list.forEach(p => {
        const div = document.createElement("div");
        div.className = "bg-[#1a1d25] border border-gray-800 rounded-2xl p-5 card-hover";
        // Category color coding
        let categoryColor = 'bg-gray-500';
        if (p.category === 'Training') categoryColor = 'bg-green-600';
        else if (p.category === 'Guidelines') categoryColor = 'bg-yellow-600';
        else if (p.category === 'Announcements') categoryColor = 'bg-red-600';
        else if (p.category === 'Updates') categoryColor = 'bg-blue-600';
        
        div.innerHTML = `
          <h3 class="text-lg font-semibold mb-2">${p.title}</h3>
          <p class="text-sm text-gray-400 mb-3">${p.content.substring(0,80)}...</p>
          <span class="text-xs ${categoryColor} px-2 py-1 rounded font-medium">${p.category}</span>
          <div class="flex justify-between items-center mt-4 text-sm">
            <div class="flex gap-3">
              <button class="text-blue-400 hover:text-blue-300" onclick="viewPost(${p.id})">View</button>
              <button class="text-green-400 hover:text-green-300" onclick="editPost(${p.id})">Update</button>
              <button class="text-red-400 hover:text-red-300" onclick="deletePost(${p.id})">Delete</button>
            </div>
          </div>`;
        postsContainer.appendChild(div);
      });
    }

    function openAddModal() {
      modalTitle.textContent = "Add New Post";
      editId.value = "";
      postForm.reset();
      postModal.classList.add("active");
    }

    function closeModal() {
      postModal.classList.remove("active");
    }

    postForm.addEventListener("submit", e => {
      e.preventDefault();
      const id = editId.value;
      const newPost = {
        id: id ? parseInt(id) : Date.now(),
        title: document.getElementById("post-title").value,
        category: document.getElementById("post-category").value,
        content: document.getElementById("post-content").value,
      };
      if (id) {
        const index = posts.findIndex(p => p.id == id);
        posts[index] = newPost;
        showNotification("Post updated successfully.", "success");
      } else {
        posts.push(newPost);
        showNotification("New post created.", "success");
      }
      // Re-render and close modal
      applyFilters(); 
      closeModal();
    });

    function editPost(id) {
      const post = posts.find(p => p.id === id);
      modalTitle.textContent = "Edit Post";
      editId.value = id;
      document.getElementById("post-title").value = post.title;
      document.getElementById("post-category").value = post.category;
      document.getElementById("post-content").value = post.content;
      postModal.classList.add("active");
    }
    
    // Updated to use Delete Modal
    function deletePost(id) {
        document.getElementById("delete-id").value = id;
        document.getElementById("delete-modal").classList.add("active");
    }

    // New function: handles the actual deletion from the modal
    function confirmDelete() {
        const id = parseInt(document.getElementById("delete-id").value);
        posts = posts.filter(p => p.id !== id);
        applyFilters(); 
        closeDeleteModal();
        showNotification("Post deleted permanently.", "success");
    }

    // New function: closes the delete modal
    function closeDeleteModal() {
        document.getElementById("delete-modal").classList.remove("active");
    }

    // Updated to use View Modal
    function viewPost(id) {
      const post = posts.find(p => p.id === id);
      if (!post) return;

      let categoryColor = 'bg-gray-500';
      if (post.category === 'Training') categoryColor = 'bg-green-600';
      else if (post.category === 'Guidelines') categoryColor = 'bg-yellow-600';
      else if (post.category === 'Announcements') categoryColor = 'bg-red-600';
      else if (post.category === 'Updates') categoryColor = 'bg-blue-600';

      document.getElementById("view-modal-title").textContent = post.title;
      document.getElementById("view-modal-category").textContent = post.category;
      // Replaces the class entirely to ensure the correct color is applied
      document.getElementById("view-modal-category").className = `text-xs ${categoryColor} px-2 py-1 rounded font-medium mb-4 inline-block`;
      // Replace newlines with <br> for proper display in the HTML modal
      document.getElementById("view-modal-content").innerHTML = post.content.replace(/\n/g, '<br>'); 
      document.getElementById("view-modal").classList.add("active");
    }
    
    // New function: closes the view modal
    function closeViewModal() {
        document.getElementById("view-modal").classList.remove("active");
    }
    
    // --- START: Filter Logic (Kept Unified and Working) ---

    // Unified function to apply both search query and category filter
    function applyFilters() {
        const query = document.getElementById("search-input").value.toLowerCase();
        const category = document.getElementById("category-filter").value;

        const filteredList = posts.filter(p => {
            const titleMatch = p.title.toLowerCase().includes(query);
            // If category is empty (''), it matches all categories.
            const categoryMatch = !category || p.category === category; 
            
            return titleMatch && categoryMatch;
        });

        renderPosts(filteredList);
    }

    function filterPosts(query) {
      applyFilters();
    }

    function filterByCategory(cat) {
      applyFilters();
    }

    function clearFilters() {
      document.getElementById("search-input").value = "";
      document.getElementById("category-filter").value = "";
      applyFilters();
    }
    
    // --- END: Filter Logic ---

    // Updated logout to use Notification
    document.getElementById("logout-btn").onclick = () => {
        showNotification("You have been successfully logged out.", "info");
        // Add actual logout logic here (e.g., redirect or clear session)
    };

    // Initialize the post rendering on load
    renderPosts();
  </script>
</body>
</html>

